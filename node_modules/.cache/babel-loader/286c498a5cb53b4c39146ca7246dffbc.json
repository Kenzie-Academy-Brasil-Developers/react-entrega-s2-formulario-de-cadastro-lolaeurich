{"ast":null,"code":"import _slicedToArray from\"/home/igor/Kenzie - M3/Entregas/Formul\\xE1rio-sem-tsx/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/igor/Kenzie - M3/Entregas/Formul\\xE1rio-sem-tsx/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/igor/Kenzie - M3/Entregas/Formul\\xE1rio-sem-tsx/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";//Usando o context para armazenar minhas informações usadas no Login e no register\nimport{createContext,useEffect,useState}from\"react\";import axios from\"axios\";//usado para dar alertas como o toastify\nimport Swal from\"sweetalert2\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";export var UserContext=/*#__PURE__*/createContext({});var UserProvider=function UserProvider(_ref){var children=_ref.children;var navigate=useNavigate();//utilizando o useEffect para montagem e validação do login\nuseEffect(function(){var token=localStorage.getItem('userToken');if(!token){navigate('/');return;}function validateLogin(){return _validateLogin.apply(this,arguments);}function _validateLogin(){_validateLogin=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('https://kenziehub.herokuapp.com/profile',{headers:{Authorization:\"Bearer \".concat(token)}});case 2:res=_context.sent;console.log('effect do context',res.data);setUser(res.data);case 5:case\"end\":return _context.stop();}}},_callee);}));return _validateLogin.apply(this,arguments);}if(token){validateLogin();}},[]);var _useState=useState({}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];//pega meus dados, dá os alertas necessários e depois, em caso de erro, me mostra os erros e os alertas.\nvar userRegister=function userRegister(data){axios.post(\"https://kenziehub.herokuapp.com/users\",data).then(function(response){Swal.fire({icon:\"success\",tittle:\"Cadastro feito com sucesso!\",text:\"Estamos quase lá!\"});//mostra para onde a página redireciona\nnavigate(\"/\");})//não redireciona, a menos que a pessoa coloque um e-mail válido\n.catch(Swal.fire({icon:\"error\",title:\"Xiii!\",text:\"Esse e-mail já foi utilizado antes!\"}));};//Usando meu usuário para logar\nvar addUser=function addUser(data){axios.post(\"https://kenziehub.herokuapp.com/sessions\",data).then(function(response){setUser(response);window.localStorage.clear();window.localStorage.setItem(\"userToken\",response.data.token);window.localStorage.setItem(\"userName\",response.data.user.name);//alertas dados no login\nSwal.fire({icon:\"success\",title:\"Redirecionando usuário...\",text:\"Successo!\"});//quando loga vai direto pro dashboard\nnavigate(\"/dashboard\");}).catch(function(err){window.localStorage.clear(\"userId\",\"userToken\");//alertas de erro no login\nSwal.fire({icon:\"error\",title:\"Eita!\",text:\"Você não possui cadastro! =(\"});});console.log(data);/*const validToken = (token) => {\n      axios.get(\"https://kenziehub.herokuapp.com/profile\", {\n        headers: {\n          Authorization: `Bearer ${token}` \n        }\n      })\n\n      /*const validToken = (data) => {\n        axios\n        .get(\"https://kenziehub.herokuapp.com/profile\", data)\n        .then((response) => {\n          setUser(response)\n            window.localStorage.clear()\n            window.localStorage.setItem(\"userToken\", response.data.token)\n            window.localStorage.setItem(\"userName\", response.data.user.name)\n        .catch((err) => {\n          console.log(\"ops! ocorreu um erro\" + err)\n        })  \n        }, [])*/};return/*#__PURE__*/_jsx(UserContext.Provider,{value:{addUser:addUser,userRegister:userRegister,user:user},children:children});};export default UserProvider;","map":{"version":3,"names":["createContext","useEffect","useState","axios","Swal","useNavigate","UserContext","UserProvider","children","navigate","token","localStorage","getItem","validateLogin","get","headers","Authorization","res","console","log","data","setUser","user","userRegister","post","then","response","fire","icon","tittle","text","catch","title","addUser","window","clear","setItem","name","err"],"sources":["/home/igor/Kenzie - M3/Entregas/Formulário-sem-tsx/src/contexts/UserContext.jsx"],"sourcesContent":["//Usando o context para armazenar minhas informações usadas no Login e no register\nimport { createContext, useEffect, useState } from \"react\"\nimport axios from \"axios\"\n\n//usado para dar alertas como o toastify\nimport Swal from \"sweetalert2\"\nimport { useNavigate } from \"react-router-dom\"\n\nexport const UserContext = createContext({})\n\nconst UserProvider = ({ children }) => {\n\n  const navigate = useNavigate()\n  \n\n\n  //utilizando o useEffect para montagem e validação do login\n  useEffect(() => {\n    const token = localStorage.getItem('userToken')\n    if(!token){\n      navigate('/')\n      return\n    }\n\n    async function validateLogin (){    \n          const res = await axios.get('https://kenziehub.herokuapp.com/profile', {\n            headers: {\n              Authorization: `Bearer ${token}`\n              }\n            })\n  \n        console.log('effect do context', res.data);\n        setUser(res.data)\n    }\n\n    if(token){\n      validateLogin()\n    }\n\n  }, [])\n\n  const [user, setUser] = useState({})\n\n  \n\n  //pega meus dados, dá os alertas necessários e depois, em caso de erro, me mostra os erros e os alertas.\n  const userRegister = (data) => {\n    axios\n      .post(\"https://kenziehub.herokuapp.com/users\", data)\n      .then((response) => {\n        Swal.fire({\n          icon: \"success\",\n          tittle: \"Cadastro feito com sucesso!\",\n          text: \"Estamos quase lá!\",\n      })\n\n        //mostra para onde a página redireciona\n        navigate(\"/\")\n      })\n\n      //não redireciona, a menos que a pessoa coloque um e-mail válido\n      .catch(\n        Swal.fire({\n          icon: \"error\",\n          title: \"Xiii!\",\n          text: \"Esse e-mail já foi utilizado antes!\",\n        })\n      )\n  }\n\n  //Usando meu usuário para logar\n  const addUser = (data) => {\n    axios\n      .post(\"https://kenziehub.herokuapp.com/sessions\", data)\n      .then((response) => {\n        setUser(response)\n        window.localStorage.clear()\n        window.localStorage.setItem(\"userToken\", response.data.token)\n        window.localStorage.setItem(\"userName\", response.data.user.name)\n\n        //alertas dados no login\n        Swal.fire({\n         icon: \"success\",\n         title: \"Redirecionando usuário...\",\n         text: \"Successo!\"})\n\n        //quando loga vai direto pro dashboard\n        navigate(\"/dashboard\")\n      })\n\n      .catch((err) => {\n        window.localStorage.clear(\"userId\", \"userToken\")\n        //alertas de erro no login\n        Swal.fire({\n            icon: \"error\",\n            title: \"Eita!\",\n            text: \"Você não possui cadastro! =(\",\n        })\n      })\n      console.log(data)\n\n\n      /*const validToken = (token) => {\n      axios.get(\"https://kenziehub.herokuapp.com/profile\", {\n        headers: {\n          Authorization: `Bearer ${token}` \n        }\n      })\n\n      /*const validToken = (data) => {\n        axios\n        .get(\"https://kenziehub.herokuapp.com/profile\", data)\n        .then((response) => {\n          setUser(response)\n            window.localStorage.clear()\n            window.localStorage.setItem(\"userToken\", response.data.token)\n            window.localStorage.setItem(\"userName\", response.data.user.name)\n        .catch((err) => {\n          console.log(\"ops! ocorreu um erro\" + err)\n        })  \n        }, [])*/\n\n  }\n\n  return (\n    <UserContext.Provider value={{ addUser, userRegister, user }}>\n      {children}\n    </UserContext.Provider>\n  )\n}\nexport default UserProvider"],"mappings":"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"},"metadata":{},"sourceType":"module"}